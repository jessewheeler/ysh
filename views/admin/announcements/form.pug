extends ../layout

block page_title
  if announcement
    | Edit Announcement
  else
    | New Announcement

block content
  form(method="POST" action=announcement ? `/admin/announcements/${announcement.id}` : '/admin/announcements' enctype="multipart/form-data" data-draft="announcement")
    .form-group
      label(for="title") Title *
      input#title(type="text" name="title" value=(announcement ? announcement.title : '') required)
    .form-group
      label(for="body") Body
      textarea#body(name="body" rows="4")= announcement ? announcement.body : ''
    .form-group
      label(for="image") Image
      input#image(type="file" name="image" accept="image/*")
      if announcement && announcement.image_path
        .image-preview
          img(src=announcement.image_path alt="Current image" style="max-height:120px; margin-top:0.5rem")
          input(type="hidden" name="existing_image" value=announcement.image_path)
    .form-group
      label(for="link_url") Link URL
      input#link_url(type="url" name="link_url" value=(announcement ? announcement.link_url : ''))
    .form-group
      label(for="link_text") Link Text
      input#link_text(type="text" name="link_text" value=(announcement ? announcement.link_text : ''))
    .form-grid
      .form-group
        label(for="sort_order") Sort Order
        input#sort_order(type="number" name="sort_order" value=(announcement ? announcement.sort_order : 0))
      .form-group
        label
          input(type="checkbox" name="is_published" value="1" checked=(announcement ? announcement.is_published : true))
          |  Published

    .form-actions
      button.btn(type="submit")= announcement ? 'Update' : 'Create'
      a.btn-outline(href="/admin/announcements") Cancel
